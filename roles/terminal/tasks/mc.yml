---
- name: Ensure Midnight Commander config directory exists
  file:
    path: "{{ mc_paths.config_dir }}"
    state: directory
    mode: "0755"

- name: Ensure Midnight Commander skin directory exists
  file:
    path: "{{ mc_paths.skin_dir }}"
    state: directory
    mode: "0755"

- name: Configure Midnight Commander preferences
  template:
    src: mc.ini.j2
    dest: "{{ mc_paths.config_dir }}/ini"
    mode: "0644"

- name: Configure Midnight Commander key bindings (vim-style j/k)
  copy:
    src: mc.keymap
    dest: "{{ mc_paths.config_dir }}/mc.keymap"
    mode: "0644"

- name: Ensure ~/.local/bin exists for mc viewer script
  file:
    path: "{{ ansible_env.HOME }}/.local/bin"
    state: directory
    mode: "0755"

- name: Install mc external viewer helper (vim + kitty)
  copy:
    src: mc-view
    dest: "{{ ansible_env.HOME }}/.local/bin/mc-view"
    mode: "0755"

- name: Deploy Midnight Commander One Dark skin
  template:
    src: "{{ mc_skin_template }}"
    dest: "{{ mc_paths.skin_dir }}/{{ mc_skin_name }}.ini"
    mode: "0644"
  when: mc_skin_template is defined
